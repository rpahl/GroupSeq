<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This vignette shows how to use GroupSeq to compute group sequential designs under the null hypothesis, introduces all available options and discusses some nuances of certain design types.
">
<title>-1- Compute Bounds • GroupSeq</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="-1- Compute Bounds">
<meta property="og:description" content="This vignette shows how to use GroupSeq to compute group sequential designs under the null hypothesis, introduces all available options and discusses some nuances of certain design types.
">
<meta property="og:image" content="https://github.com/rpahl/GroupSeq/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GroupSeq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html" aria-label="home">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/GroupSeq.html">Get Started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/index.html">Overview</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/understanding-gs-designs.html">Understanding group sequential designs</a>
    <a class="dropdown-item" href="../articles/GroupSeq.html">Introduction to GroupSeq</a>
    <a class="dropdown-item" href="../articles/task-1-compute-bounds-H0.html">-1- Compute Bounds</a>
    <a class="dropdown-item" href="../articles/task-2-compute-drift.html">-2- Compute Drift given Power and Bounds</a>
    <a class="dropdown-item" href="../articles/task-3-compute-bounds-H1.html">-3- Compute Probabilities given Bounds and Drift</a>
    <a class="dropdown-item" href="../articles/task-4-compute-CI.html">-4- Compute Confidence Interval</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Other</h6>
    <a class="external-link dropdown-item" href="https://www.r-project.org/doc/Rnews/Rnews_2006-2.pdf#page=21">GroupSeq article in R News 2006</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-my-packages">My Packages</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-my-packages">
    <a class="external-link dropdown-item" href="https://rpahl.github.io/container/">container</a>
    <a class="external-link dropdown-item" href="https://rpahl.github.io/GroupSeq/">GroupSeq</a>
    <a class="external-link dropdown-item" href="https://rpahl.github.io/pipeflow/">pipeflow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rpahl/container/" aria-label="github">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://stackoverflow.com/users/8120617/rpahl" aria-label="stackoverflow">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://bsky.app/profile/rpahl.bsky.social" aria-label="bluesky">
    <span class="fab fa fab fa-bluesky"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://rpahl.github.io/r-some-blog/" aria-label="blog">
    <span class="fas fa fas fa-blog"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>-1- Compute Bounds</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rpahl/GroupSeq/blob/HEAD/vignettes/task-1-compute-bounds-H0.Rmd"><code>vignettes/task-1-compute-bounds-H0.Rmd</code></a></small>
      <div class="d-none name"><code>task-1-compute-bounds-H0.Rmd</code></div>
    </div>

    
    
<p>The option -1- menu initially looks as follows.</p>
<p><img src="figures/task1-menu.png" alt="task-1-menu" width="35%"></p>
<div class="section level3">
<h3 id="single-stage">Single stage<a class="anchor" aria-label="anchor" href="#single-stage"></a>
</h3>
<p>As a first example, let’s hit the <code>CALCULATE</code> button,
which should open a new window with the following results.</p>
<p><img src="figures/task1-1stage-result.png" alt="one-stage-result" width="50%"></p>
<p>Since the number stages was set to <span class="math inline">\(K =
1\)</span>, we just calculated one-sided bounds for a simple 1-stage
design, which is equivalent to</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="co"># [1] 1.644853627</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obrien-fleming-3-stage-design">O’Brien-Fleming 3-stage design<a class="anchor" aria-label="anchor" href="#obrien-fleming-3-stage-design"></a>
</h3>
<p>To obtain a true group sequential design, we have to select <span class="math inline">\(K &gt; 1\)</span> stages. The number of stages is
chosen at the top of the window. Note that in GroupSeq this is called
<code>#Interim Times</code>, which means that the final analysis also is
treated as an ‘interim time’. Thus, for a 3-stage design, we select
<span class="math inline">\(K = 3\)</span>.</p>
<p><img src="figures/task1-select-K3.png" alt="task-1-select-K3" width="25%"><br></p>
<p>Hit <code>CALCULATE</code> to compute the 3-stage design.</p>
<p><img src="figures/task1-3stage-result.png" alt="three-stage-result" width="50%"></p>
<p><br></p>
<p>In the second to last column, you see how much alpha is spent at each
stage, while in the last column you see the cumulative alpha, which
should sum up to the overall significance level (here 5%).</p>
<p>Obviously, there are infinitely many ways to split the 5% over the
three stages. The default alpha spending strategy in GroupSeq is the
O’Brien-Fleming type, which is probably the most popular group
sequential design in clinical trials.</p>
<p>As you see, the O’Brien-Fleming is very conservative at the early
stages of the study so that only 0.069% of alpha is spent at stage 1.
The effect therefore would have to be very large in order to exceed the
critical upper bound of 3.2 at stage 1 when 33% of the total sample will
have been collected.</p>
<p>To get a visual impression you can click the <code>Show Graph</code>
button in the result window which provides the following plot.</p>
<p><img src="figures/task1-3stage-result-graph.png" alt="three-stage-result-graph" width="50%"></p>
<p><br> The advantage of this conservative strategy is that you still
leave enough alpha for the final analysis to reject <code>H0</code> for
significant but moderate effects.</p>
</div>
<div class="section level3">
<h3 id="pocock-3-stage-design">Pocock 3-stage design<a class="anchor" aria-label="anchor" href="#pocock-3-stage-design"></a>
</h3>
<p>Another popular design, which actually had a significant positive
impact on the general popularity of group sequential designs in clinical
research, is the design by Pocock, which is constructed such the bounds
are identical at each stage. Let’s select
<code>(5) Exact Pocock Bounds</code> and hit
<code>CONFIRM FUNCTION</code>.</p>
<p><img src="figures/task1-3stage-pocock.png" alt="three-stage-pocock-bounds" width="35%"></p>
<p><br> When hitting the <code>CALCULATE</code> button, this time we get
the following.</p>
<p><img src="figures/task1-3stage-pocock-result.png" alt="three-stage-pocock-results" width="55%"><img src="figures/task1-3stage-pocock-result-graph.png" alt="three-stage-pocock-results" width="40%"></p>
<p><br> The resulting upper bounds are set constant over all stages at
1.99. Obviously this design is more aggressive than the O’Brien-Fleming
design in trying to abort early as 0.023% of alpha is already spent at
the first stage (see second to last column in above figure).</p>
<p>While the critical bounds are constant over all stages, the spent
alpha is not. Rather it is decreasing with each stage. This is “caused”
by the sample size, which is increasing on later stages, so that,
roughly speaking, it gets less likely under <code>H0</code> to produce a
type I error.</p>
</div>
<div class="section level3">
<h3 id="obrien-fleming-vs-pocock">O’Brien-Fleming vs Pocock<a class="anchor" aria-label="anchor" href="#obrien-fleming-vs-pocock"></a>
</h3>
<p>When comparing the final stage of both designs, the spent alpha in
the O’Brien-Fleming design (0.034%) is roughly three times higher than
in the Pocock design (0.011%), which means that if the study is not
aborted at one of the interim analysis, once you reach the final stage
the effect needs to be much higher in the Pocock design to reject
<code>H0</code> at the final stage.</p>
<p>Beside the statistical power there are other aspects such as the
expected sample size that can be taken into consideration when comparing
designs which however goes beyond the scope of this vignette. This is
also true with respect to the other available designs<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;To be exact, these are alpha spending functions, which
lead to certain types of designs.&lt;/p&gt;"><sup>1</sup></a>, and it is recommended
to consult the literature to study the properties of the different
designs.</p>
<p>You may have also noted that among the available design functions
there is <code>(2) Pocock type</code>, which is is very similar to
option <code>(5) Exact Pocock Bounds</code>. The
<code>(2) Pocock type</code> is based on the alpha spending approach,
which always produces monotonously decreasing bounds and therefore does
not yield exact Pocock bounds by definition. Since the Pocock design is
very popular, the option of exact Pocock bounds, which are slightly
harder to compute, was added to GroupSeq.</p>
</div>
<div class="section level3">
<h3 id="non-equidistant-interim-times">Non-equidistant interim times<a class="anchor" aria-label="anchor" href="#non-equidistant-interim-times"></a>
</h3>
<p>To adjust interim times, which by default are equally spaced, the
correspondin checkmark has to be deselected.
<img src="figures/task1-3stage-pocock-custom-times.png" alt="three-stage-pocock-custom-times" width="35%"></p>
<p><br> The times are entered manually, for example, lets start a bit
later with the first interim look.</p>
<p><img src="figures/task1-3stage-pocock-custom-times-entered.png" alt="three-stage-pocock-custom-times" width="35%"></p>
<p><br> and <code>CALCULATE</code>.</p>
<p><img src="figures/task1-3stage-pocock-custom-times-result.png" alt="three-stage-pocock-custom-times-result" width="50%"></p>
<p><br> We see that this leads to slightly lower bounds, which seems
about right as this design is less aggressive to abort the study
early.</p>
</div>
<div class="section level3">
<h3 id="two-sided-bounds">Two-Sided bounds<a class="anchor" aria-label="anchor" href="#two-sided-bounds"></a>
</h3>
<p>Last but not least, the designs can be calculated for the two-sided
symmetric</p>
<p><img src="figures/task1-3stage-pocock-two-side.png" alt="three-stage-pocock-two-side" width="35%"></p>
<p><br> as well as the two-sided asymmetric case.</p>
<p><img src="figures/task1-3stage-pocock-two-side-asym.png" alt="three-stage-pocock-two-side-asym" width="35%"></p>
<p><br> Naturally, the alpha is split up symmetrically, but can be
customized if needed. Also the alpha spending function has to be set
separately for each side. As an example, lets go with O’Brien-Fleming
and Pocock again (don’t forget to hit the <code>CONFIRM FUNCTION</code>
buttons).</p>
<p><img src="figures/task1-3stage-pocock-two-side-asym-result.png" alt="three-stage-pocock-two-side-asym-result" width="55%"><img src="figures/task1-3stage-pocock-two-side-asym-graph.png" alt="three-stage-pocock-two-side-asym-result" width="40%"></p>
<p><br> Looking at the stage-wise alpha spending, we literally end up
with a mixture of both designs as there is some alpha spend on the early
stages but still saved some for the last stage.</p>
<p>So this is mainly what can be done with GroupSeq to construct designs
under <code>H0</code>. Next lets see how to calculate probabilities
under <code>H1</code> and specifically to determine the effect size that
is required to achieve a certain probability (i.e. power) to detect an
existing effect, which can be done via the second menu option: <a href="https://rpahl.github.io/GroupSeq/articles/task-2-compute-drift.html" class="external-link">-2-
Compute Drift given Power and Bounds</a></p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://rpahl.github.io/r-some-blog/about.html" class="external-link">Roman Pahl</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
