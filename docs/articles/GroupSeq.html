<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to GroupSeq • GroupSeq</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to GroupSeq">
<meta property="og:description" content="Start here if this is your first time using GroupSeq. This vignette gives a brief overview on *what* and *what not* can be done with GroupSeq.
">
<meta property="og:image" content="https://github.com/rpahl/GroupSeq/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GroupSeq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/GroupSeq.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a></a>
    </li>
    <li>
      <a href="../articles/index.html">Overview</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/GroupSeq.html">General Introduction</a>
    </li>
    <li>
      <a href="../articles/1-compute-bounds-H0.html">-1- Compute Bounds</a>
    </li>
    <li>
      <a href="../articles/2-compute-drift.html">-2- Compute Drift given Power and Bounds</a>
    </li>
    <li>
      <a href="../articles/3-compute-bounds-H1.html">-3- Compute Probabilities given Bounds and Drift</a>
    </li>
    <li>
      <a href="../articles/4-compute-CI.html">-4- Compute Confidence Interval</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Other</li>
    <li>
      <a href="https://www.r-project.org/doc/Rnews/Rnews_2006-2.pdf#page=21">GroupSeq article in R News 2006</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    My Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://rpahl.github.io/container/">container</a>
    </li>
    <li>
      <a href="https://rpahl.github.io/GroupSeq/">GroupSeq</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rpahl/GroupSeq/">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/users/8120617/rpahl">
    <span class="fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/romanpahl">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://rpahl.github.io/r-some-blog/">
    <span class="fas fa-blog"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="GroupSeq_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to GroupSeq</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rpahl/GroupSeq/blob/master/R/vignettes/GroupSeq.Rmd"><code>R/vignettes/GroupSeq.Rmd</code></a></small>
      <div class="hidden name"><code>GroupSeq.Rmd</code></div>

    </div>

    
    
<div id="note-this-vignette-is-still-under-construction" class="section level1">
<h1 class="hasAnchor">
<a href="#note-this-vignette-is-still-under-construction" class="anchor"></a>Note: this vignette is still under construction</h1>
<div id="how-to-calculate-group-sequential-design-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-calculate-group-sequential-design-probabilities" class="anchor"></a>How to calculate group sequential design probabilities</h2>
<p>While calculating probabilities of group sequential designs can be considered somewhat complex, it may be less difficult than most people think. This vignette provides a visual explanation of the underlying method to help forming an intuitive understanding of this topic. The author is convinced that gaining an intuitive understanding of these calculations helps when applying and interpreting such designs in practice.</p>
<div id="one-sample-study" class="section level3">
<h3 class="hasAnchor">
<a href="#one-sample-study" class="anchor"></a>One-sample study</h3>
<p>Following the easy-to-hard principle, we start with conventional non-sequential study designs and gradually progress to the group sequential case.</p>
<p>Consider you have a sample of data, let’s call it <code>X1</code>.</p>
<p><img src="GroupSeq_files/figure-html/unnamed-chunk-2-1.png" width="35%" style="display: block; margin: auto;"><br> Next you calculate a standardized test statistic. Assuming a standard normal distribution, the density distribution under the null hypothesis forms the well-known bell-shaped curve.</p>
<div class="figure">
<img src="GroupSeq_files/figure-html/unnamed-chunk-3-1.png" alt="Standard Normal Density with critial bounds marking 5% significance level." width="65%"><p class="caption">
Standard Normal Density with critial bounds marking 5% significance level.
</p>
</div>
<p><br> If a two-sided test is planned with a significance level of <span class="math inline">\(\alpha = 5\%\)</span>, the critical bounds are set as visualized in the above figure. In the days before computers these bounds had to be looked up in tables in some book, but these days of course you just plug-in the numbers in your favorite statistics program. In R its</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span>
<span class="co"># [1] -1.959963985</span></code></pre></div>
<p>Now what do these bounds mean? Basically, if the null hypothesis (<span class="math inline">\(H_0\)</span>) was true, the probability of obtaining a test statistic at or beyond these bounds is <span class="math inline">\(2\cdot 0.025 = 0.05\)</span>, which therefore limits the so-called type I error (rejecting <span class="math inline">\(H_0\)</span> although its true) at 5%.</p>
<p>Going forward the key thing to notice is that calculating this probability basically means <em>calculating the (blue) area under the density curve</em> (see above figure). Again, these days it’s easy to derive the area using computer’s numerical integration.</p>
</div>
<div id="combining-two-studies" class="section level3">
<h3 class="hasAnchor">
<a href="#combining-two-studies" class="anchor"></a>Combining two studies</h3>
<p>Now lets consider another sample <code>X2</code> that was collected independently from <code>X1</code>.</p>
<p><img src="GroupSeq_files/figure-html/unnamed-chunk-5-1.png" width="35%" style="display: block; margin: auto;"></p>
<p><br> If we construct a distribution similar to the one above, we have the following.</p>
<p><img src="GroupSeq_files/figure-html/unnamed-chunk-6-1.png" width="85%"></p>
<p><br> A statistical test on both samples now would control the type I error for each of these studies at the 5% level, but, of course, things are more complicated if you consider both samples at the same time, because now you have two chances of conducting the error.</p>
<p>So if we assume our samples <code>X1</code> and <code>X2</code> were sampled from the same population and we are interested to test the same outcome, to control the <em>overall</em> type I error at 5% we need to down-adjust alpha. The simplest and most common approach is to use the Bonferroni correction, which means we are allowed to spend <span class="math inline">\(\alpha_B = \alpha/2 = 0.025\)</span>. The corresponding critical bound is</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="co"># [1] -2.241402728</span></code></pre></div>
<p>and we have</p>
<p><img src="GroupSeq_files/figure-html/unnamed-chunk-9-1.png" width="85%"></p>
<p>So if we calculate the overall type I error probability, we sum up all the areas and get <span class="math inline">\(p = 1.25\% + 1.25\%+ 1.25\% + 1.25\% = 5\%\)</span>. So we are good, are we? Well, the devil is in the details.</p>
<p>Remember, the goal was to make sure that we don’t conduct a type I error. The probability to conduct no type I at either <code>X1</code> or <code>X2</code> is <span class="math inline">\(1-\alpha_B = 1-0.025 = 0.975\)</span>.</p>
<p>From this it follows that the probability to conduct no error at both <code>X1</code> and <code>X2</code> is <span class="math inline">\((1-\alpha_B)^2 = 0.950625\)</span>.</p>
<p>Now we can calculate the complementary probability of conducting <em>at least one</em> type I error* as <span class="math inline">\(1 - (1-\alpha_B)^2 = 0.049375 = 4.9\%\)</span>. Wait, why is this not 5%? The reason is that we don’t care if one or both studies produce a type I error, as one error is already enough for the overall setup to fail. For this reason the Bonferroni correction is not optimal, as it “wastes” 0.1% of alpha.</p>
<p><br> Of course, this is well-known and a precise alpha adjustment can be derived via the so-called <a href="https://en.wikipedia.org/wiki/%C5%A0id%C3%A1k_correction">Sidak correction</a>: <span class="math inline">\(\alpha_S* = 1 - (1-\alpha)^{1/2} = 0.02532057 &gt; \alpha_B\)</span>.</p>
<p>Plugging this into the above formula, we get <span class="math inline">\(1 - (1-\alpha_S)^2 = 0.05 = 5\%\)</span>. If you are interested, you can find the derivation of <a href="https://en.wikipedia.org/wiki/%C5%A0id%C3%A1k_correction">Sidak’s</a> formula under the link, but I have promised you to provide intuitive explanations, so let’s move to the key concept that will help to understand group sequential probabilities.</p>
</div>
<div id="combining-two-distributions" class="section level3">
<h3 class="hasAnchor">
<a href="#combining-two-distributions" class="anchor"></a>Combining two distributions</h3>
<p>Remember that determining the probability of distributions is all about calculating areas under the curve. Fortunately, two normal distributions can be combined into a bivariate normal distribution, which then looks like this.</p>
<p><img src="GroupSeq_files/figure-html/unnamed-chunk-11-1.png" width="55%"></p>
<p>Now to derive the overall type I error, we again just have to compute the area under the blue grid. To do this, we are using the <a href="https://CRAN.R-project.org/package=mvtnorm">mvtnorm</a>. To keep matters simple, we just discuss the results. For further details you can see the source code of this vignette.</p>
<p>Now if we plug in the Bonferoni bounds, the calculation of the blue area, results in p = 0.049375 while the Sidak bounds yield p = 0.05, which therefore confirms the above results.</p>
<p>However, we now also have a graphical intuitive interpretation to explain the results. For this, have a look at the next graph.</p>
<p><img src="GroupSeq_files/figure-html/unnamed-chunk-13-1.png" width="55%"></p>
<p>The grey areas mark those scenarios where both type I errors fall together. The intuitive explanation now goes like this: when calculating the overall area, the grey areas are only counted once whereas in the Bonferroni case you count them twice. To see this, we can calculate the area of one of these edges, which results in p = 0.00016 and if we subtract them from the overall alpha we get <span class="math inline">\(0.05 - 4\cdot 0.00016 = 0.04936\)</span>, which corresponds to the overall probability under Bonferroni correction.</p>
<p>So when using the bivariate normal distribution, we naturally derive at the optimal solution for the alpha adjustment. The same is true for group sequential designs, which further optimize the calculation by taking into account the dependency of the staged samples.</p>
</div>
<div id="two-stage-designs" class="section level3">
<h3 class="hasAnchor">
<a href="#two-stage-designs" class="anchor"></a>Two-stage designs</h3>
<div class="figure">
<img src="GroupSeq_files/figure-html/unnamed-chunk-14-1.png" alt="Group sequential 2-stage design with one interim look at 0.5 and O'Brien-Fleming type alpha spending." width="50%"><p class="caption">
Group sequential 2-stage design with one interim look at 0.5 and O’Brien-Fleming type alpha spending.
</p>
</div>
<div class="figure">
<img src="GroupSeq_files/figure-html/unnamed-chunk-15-1.png" alt="Bivariate normal density of two-stage design." width="75%"><p class="caption">
Bivariate normal density of two-stage design.
</p>
</div>
<div class="figure">
<img src="GroupSeq_files/figure-html/unnamed-chunk-16-1.png" alt="Bivariate normal density of two-stage design." width="30%"><img src="GroupSeq_files/figure-html/unnamed-chunk-16-2.png" alt="Bivariate normal density of two-stage design." width="30%"><img src="GroupSeq_files/figure-html/unnamed-chunk-16-3.png" alt="Bivariate normal density of two-stage design." width="30%"><p class="caption">
Bivariate normal density of two-stage design.
</p>
</div>
</div>
<div id="probability-distribution-of-group-sequential-designs" class="section level3">
<h3 class="hasAnchor">
<a href="#probability-distribution-of-group-sequential-designs" class="anchor"></a>Probability distribution of group sequential designs</h3>
<div class="figure">
<img src="GroupSeq_files/figure-html/unnamed-chunk-18-1.png" alt="Bivariate normal density of two-stage design." width="45%"><img src="GroupSeq_files/figure-html/unnamed-chunk-18-2.png" alt="Bivariate normal density of two-stage design." width="45%"><p class="caption">
Bivariate normal density of two-stage design.
</p>
</div>
</div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>Load the library to start the graphical user interface.</p>
<p><img src="figures/menu-after-load.png" width="30%"></p>
<p><br></p>
<p>Now the application splits into four possible tasks.</p>
<ol style="list-style-type: decimal">
<li><a href="https://rpahl.github.io/GroupSeq/articles/1-compute-bounds-H0.html">Compute Bounds</a></li>
<li><a href="https://rpahl.github.io/GroupSeq/articles/2-compute-drift.html">Compute Drift given Power and Bounds</a></li>
<li><a href="https://rpahl.github.io/GroupSeq/articles/3-compute-bounds-H1.html">Compute Probabilities given Bounds and Drift</a></li>
<li><a href="https://rpahl.github.io/GroupSeq/articles/4-compute-CI.html">Compute Confidence Interval</a></li>
</ol>
<p>To select a task, you have to hit the <code>Perform Selected Task</code> button.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rpahl.github.io/r-some-blog/about.html">Roman Pahl</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
