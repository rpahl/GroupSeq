<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sequential design probabilities — seqDesign • GroupSeq</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sequential design probabilities — seqDesign" />
<meta property="og:description" content="Computes sequential probabilities, for each stage of a given
one-sided sequential design with specified critical limits and optional
futility stops (stopping bounds). When applying the design in practice, at
each stage, all data collected up to this point is used to calculate a
combined test statistic. Then, if the test statistic is larger than the
critical limit at the specific stage, the study is stopped and the null
hypothesis rejected. If futility stops have been specified and the test
statistic falls below them at any stage, the study is also stopped due to
futility while the null hypothesis in this case cannot be discarded." />
<meta property="og:image" content="https://github.com/rpahl/GroupSeq/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GroupSeq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/GroupSeq.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a></a>
    </li>
    <li>
      <a href="../articles/index.html">Overview</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/GroupSeq.html">General Introduction</a>
    </li>
    <li>
      <a href="../articles/1-compute-bounds-H0.html">-1- Compute Bounds</a>
    </li>
    <li>
      <a href="../articles/2-compute-drift.html">-2- Compute Drift given Power and Bounds</a>
    </li>
    <li>
      <a href="../articles/3-compute-bounds-H1.html">-3- Compute Probabilities given Bounds and Drift</a>
    </li>
    <li>
      <a href="../articles/4-compute-CI.html">-4- Compute Confidence Interval</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Other</li>
    <li>
      <a href="https://www.r-project.org/doc/Rnews/Rnews_2006-2.pdf#page=21">GroupSeq article in R News 2006</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    My Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://rpahl.github.io/container/">container</a>
    </li>
    <li>
      <a href="https://rpahl.github.io/GroupSeq/">GroupSeq</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rpahl/GroupSeq/">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/users/8120617/rpahl">
    <span class="fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/romanpahl">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://rpahl.github.io/r-some-blog/">
    <span class="fas fa-blog"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sequential design probabilities</h1>
    <small class="dont-index">Source: <a href='https://github.com/rpahl/GroupSeq/blob/master/R/sequential.R'><code>R/sequential.R</code></a></small>
    <div class="hidden name"><code>seqDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes sequential probabilities, for each stage of a given
one-sided sequential design with specified critical limits and optional
futility stops (stopping bounds). When applying the design in practice, at
each stage, all data collected up to this point is used to calculate a
combined test statistic. Then, if the test statistic is larger than the
critical limit at the specific stage, the study is stopped and the null
hypothesis rejected. If futility stops have been specified and the test
statistic falls below them at any stage, the study is also stopped due to
futility while the null hypothesis in this case cannot be discarded.</p>
    </div>

    <pre class="usage"><span class='fu'>seqDesign</span><span class='op'>(</span>
  <span class='va'>crit</span>,
  mu <span class='op'>=</span> <span class='fl'>0</span>,
  sd <span class='op'>=</span> <span class='fl'>1</span>,
  tau <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>crit</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>crit</span><span class='op'>)</span>,
  futStop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>crit</span><span class='op'>)</span><span class='op'>)</span>,
  n <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>crit</th>
      <td><p><code>numeric</code> vector of critical limits for stopping the study with
rejection of the null hypothesis. The length of 'crit' determines the
number of stages of the design.</p></td>
    </tr>
    <tr>
      <th>mu</th>
      <td><p><code>numeric</code> the mean (e.g. <code>mu == 0</code> under H0). Under H1 this
is also known as the drift parameter.</p></td>
    </tr>
    <tr>
      <th>sd</th>
      <td><p><code>numeric</code> standard deviation (or vector of sd)</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p><code>numeric</code> vector of monotonely increasing information times.</p></td>
    </tr>
    <tr>
      <th>futStop</th>
      <td><p><code>numeric</code> vector of futility stopping bounds (optional).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p><code>numeric</code> sample size, which only has an effect if <code>mu != 0</code>.
Useful to compute expected sample size under H1.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments passed to <code>seqProb</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>result is a <code>list</code> with the following components:</p><ul>
<li><p><code>exitP</code> the alpha spent at each stage. The cumulative sum of this will
provides the cumulative exit probability up to each stage, that is, the
probability of having stopped due to exceeding a bound.</p></li>
<li><p><code>undecided</code> probability of continuing the study. In case of the last
stage, this means stopping without declaring significance.</p></li>
<li><p><code>cumFutStop</code> cumulative futility stop probabilities.</p></li>
<li><p><code>nk</code> planned sample size per stage.</p></li>
<li><p><code>kExp</code> expected sample size per stage - the sum over all values will
provide the total expected sample size.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># 1-stage</span>
<span class='co'># #######</span>
<span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='fl'>0.05</span>
<span class='va'>crit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>alpha</span><span class='op'>)</span>
<span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>crit</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span>                          <span class='co'># type1: 0.05 == alpha</span>
</div><div class='output co'>#&gt; [1] 0.05</div><div class='input'><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>crit</span>, mu<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span>                  <span class='co'># power: 9%</span>
</div><div class='output co'>#&gt; [1] 0.08933625</div><div class='input'><span class='co'># Increase sample size</span>
<span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>crit</span>, mu<span class='op'>=</span><span class='fl'>0.3</span>, n<span class='op'>=</span><span class='fl'>69</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span>            <span class='co'># power: 80.1%</span>
</div><div class='output co'>#&gt; [1] 0.8015397</div><div class='input'>
<span class='co'># 2-stage</span>
<span class='co'># #######</span>
<span class='va'>crit2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>crit</span>, <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># Using two stages with same critical bounds will exceed alpha</span>
<span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>crit2</span>, mu<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span><span class='op'>)</span>           <span class='co'># cumulative type1: &gt; 0.08</span>
</div><div class='output co'>#&gt; [1] 0.05000000 0.08007553</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>crit2</span>, mu<span class='op'>=</span><span class='fl'>0</span>, n<span class='op'>=</span><span class='fl'>69</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span><span class='op'>)</span>     <span class='co'># type1 does not depend on n</span>
</div><div class='output co'>#&gt; [1] 0.05000000 0.08007553</div><div class='input'>
<span class='co'># Try Bonferroni:</span>
<span class='va'>bonf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>alpha</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>bonf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span><span class='op'>)</span>                  <span class='co'># cumulative type1: 0.0415...</span>
</div><div class='output co'>#&gt; [1] 0.02500000 0.04155891</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>bonf</span>, mu<span class='op'>=</span><span class='fl'>0.3</span>, n<span class='op'>=</span><span class='fl'>69</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span><span class='op'>)</span>       <span class='co'># cumulative power: 73.1%</span>
</div><div class='output co'>#&gt; [1] 0.7313453</div><div class='input'>
<span class='co'># Bonferroni did not use all alpha, so there is room to improve power, for</span>
<span class='co'># example using Pocock like boundaries:</span>
<span class='va'>pocock</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.8662</span>, <span class='fl'>1.8848</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>pocock</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span><span class='op'>)</span>                   <span class='co'># cumulative type1: 0.05</span>
</div><div class='output co'>#&gt; [1] 0.0500047</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>pocock</span>, mu<span class='op'>=</span><span class='fl'>.3</span>, n<span class='op'>=</span><span class='fl'>69</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p</span><span class='op'>$</span><span class='va'>exit</span><span class='op'>)</span>      <span class='co'># power: 75.8%</span>
</div><div class='output co'>#&gt; [1] 0.7575743</div><div class='input'>
<span class='co'># Still the one stage power will never be reached, which is the price to pay</span>
<span class='co'># for the two potential tests. On the other hand, the expected sample size is</span>
<span class='co'># considerably smaller in comparison with the 1-stage design.</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>pocock</span>, mu<span class='op'>=</span><span class='fl'>.3</span>, n<span class='op'>=</span><span class='fl'>69</span><span class='op'>)</span><span class='op'>$</span><span class='va'>n</span><span class='op'>$</span><span class='va'>nkExp</span><span class='op'>)</span>     <span class='co'># expected sample size: 53</span>
</div><div class='output co'>#&gt; [1] 53.18018</div><div class='input'>
<span class='co'># Increasing max sample size to 98, yields expected n = 69 and power 87.8%</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>seqDesign</span><span class='op'>(</span><span class='va'>pocock</span>, mu<span class='op'>=</span><span class='fl'>.3</span>, n<span class='op'>=</span><span class='fl'>98</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>res</span>, recursive<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"n.nkExp"</span>, <span class='st'>"p.exit"</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>sum</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $n.nkExp
#&gt; [1] 68.97094
#&gt; 
#&gt; $p.exit
#&gt; [1] 0.8779636
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://rpahl.github.io/r-some-blog/about.html'>Roman Pahl</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


